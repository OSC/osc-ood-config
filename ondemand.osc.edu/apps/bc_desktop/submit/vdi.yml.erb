<%-
  args = [ "--partition", "quick", "--nodes", "1", "--ntasks-per-node", "1" ]
  args.concat ["--licenses", "#{licenses}"] unless licenses.empty?
-%>
---
batch_connect:
  before_script: |
    # Export the module function if it exists
    [[ $(type -t module) == "function"  ]] && export -f module

    # MATE acts strange in pitzer-exp and doesn't like /var/run/$(id -u)
    export XDG_RUNTIME_DIR="$TMPDIR/xdg_runtime"

    # reset SLURM_EXPORT_ENV so that things like srun & sbatch work out of the box
    export SLURM_EXPORT_ENV=ALL

script:
  accounting_id: "<%= account %>"
  native:
    <%- args.each do |arg| -%>
    - "<%= arg %>"
    <%- end -%>
